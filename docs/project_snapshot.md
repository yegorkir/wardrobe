## 1) Что уже сделано в проекте 

### 1.1. Сцены и топология экрана

**WorkdeskScene** уже собирает нужную “один экран” структуру:

* **Storage Hall** сверху: сетка шкафов **3 столбца × 2 ряда** (CabinetsGrid), плюс отдельные узлы под **шторы/свет** (есть как объекты сцены).
* **Service Zone** снизу: **две стойки обслуживания** (Desk_A / Desk_B).
* Есть **FloorZone** внизу (минимум 2 зоны пола).

Также уже есть **HookBoard** со **сдвоенными крючками** (два слота на крючок) и **кабинет**, где помимо hook-слота есть **полка-поверхность** (ShelfSurface) для псевдофизической раскладки.

Итого: базовая геометрия “склад + две стойки + пол” — уже в сценах.

---

### 1.2. Drag-and-drop и “физичность” предметов

Есть рабочая вертикаль:

* **Курсор-рука** (CursorHand) с режимами “крупный/мелкий” (тот самый chameleon-preview по смыслу).
* **WardrobeDragDropAdapter**:

  * один предмет “в руке”,
  * выбор цели по наведению,
  * попытка разместить в слот/на полку,
  * если нельзя — **дроп на пол** как дефолтное последствие.
* Поддержаны **операции взаимодействия** на слотах через концепт **PICK/PUT/SWAP** (в коде это есть как единая модель взаимодействий).

Важно: в текущем срезе **“невалидный дроп” уже ведёт к падению на пол**, то есть основа твоего “наказание за неаккуратность = физика” уже проложена.

---

### 1.3. Полки/крючки/пол как разные поверхности

В проекте есть разделение:

* **Hook/slot**: дискретные места (слоты).
* **ShelfSurface**: поверхность, где предметы занимают место и могут “не влезть”.
* **FloorZone**: дефолтное место падения.

Плюс есть инфраструктура для “приземления” и эффектов от приземления (landing behaviors): например, разные типы предметов могут вести себя по-разному при падении (bounce/break/burn и т.п.). Это пока **не звёзды качества**, но это уже “каркас последствий”.

---

### 1.4. Клиенты, две фазы и стойка как state machine

Есть **DeskServicePointSystem** с фазами клиента:

* **DROP_OFF** (сдача): клиент ожидает **COAT** на стойке, игрок меняет на **TICKET** через swap.
* **PICK_UP** (выдача): клиент приходит с **TICKET**, ожидает **COAT**.

То есть “двухфазность” как машина состояний уже реализована.

**Wrong item** сейчас обрабатывается как **rejected delivery event** (логически “не то принесли”), но:

* в этом срезе **оно не выталкивает предмет на пол автоматически** и не бьёт качество звёздами (звёзд вообще как системы пока нет).
* то есть “реакция клиента” — есть, “физическое наказание wrong item → на пол” — это ещё надо довести.

---

### 1.5. Patience/волна/конец смены — реализовано, но не в твоей текущей фиксации

В текущем срезе **WorkdeskScene**:

* тикает время волны,
* тикает patience у клиентов,
* и **patience=0 сейчас приводит к провалу волны/смены** (если не включён дебаг-флаг, который этот фейл обходит).

По твоей актуальной фиксации v0.4 нужно иначе:

* **patience=0 блокирует только свой слот**,
* **увольнение/lose** по **3 страйкам** (переход >0 → 0),
* смена завершается по **N_checkin/N_checkout**.

Значит: текущая реализация — это “старое правило”, и его реально придётся переписать.

---

### 1.6. Документация/шаги и тесты

В docs/tests есть следы пошаговой разработки (Step 3/4/5/6.x), тесты на часть поведения (особенно вокруг drag/drop, поверхностей, landing-эффектов). Это хорошо: есть куда вкручивать новые правила без полной перепайки.

---

## 2) Что сейчас НЕ соответствует твоей целевой версии (это и есть кандидаты на следующий шаг)

Коротко, без философии:

1. **Patience=0 и lose-логика** сейчас “жёсткая” (фейл сразу), а ты зафиксировал “B1 + 3 страйка”.
2. **Wrong item → выталкивание на пол + минус patience (типозависимо) + урон как обычное падение (D1)** — в коде пока есть только “rejected event”.
3. **Смена по двум счётчикам N_checkin/N_checkout** — текущая логика волны другая.
4. **items_per_client > 1 и “вываливает кучей”** — текущая стойка/модель предметов заточена под 1 coat в слот и swap.
5. **Свет/зомби/вампир/призрак/звёзды качества** — как целевая система ещё не реализованы (есть лишь зачатки “эффектов приземления”, но не качество).
